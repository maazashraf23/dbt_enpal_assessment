{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.11.2", "generated_at": "2026-01-31T20:54:50.561964Z", "invocation_id": "5506cb9c-15a2-4810-a01a-2bff4c7ed504", "invocation_started_at": "2026-01-31T20:54:47.614806Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:49.590687Z", "completed_at": "2026-01-31T20:54:49.609335Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:49.611336Z", "completed_at": "2026-01-31T20:54:49.611336Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.022649288177490234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.enpal_assessment_project.stg_pipedrive_activity", "compiled": true, "compiled_code": "\n\nwith source as (\n    select *\n    from \"postgres\".\"public\".\"activity\"\n    \n    where due_to::timestamp >= (\n        select coalesce(max(due_at), '1900-01-01'::timestamp)\n        from \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"stg_pipedrive_activity\"\n    )\n    \n),\n\nrenamed as (\n    select\n        activity_id::int as activity_id,\n        type as activity_type,\n        assigned_to_user::int as assigned_to_user_id,\n        deal_id::int as deal_id,\n        done::boolean as is_done,\n        due_to::timestamp as due_at\n    from source\n)\n\nselect *\nfrom renamed", "relation_name": "\"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"stg_pipedrive_activity\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:49.614854Z", "completed_at": "2026-01-31T20:54:49.619987Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:49.620987Z", "completed_at": "2026-01-31T20:54:49.620987Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00713801383972168, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.enpal_assessment_project.stg_pipedrive_activity_types", "compiled": true, "compiled_code": "\n\nwith source as (\n    select *\n    from \"postgres\".\"public\".\"activity_types\"\n),\n\nrenamed as (\n    select\n        id::int as activity_type_id,\n        name as activity_type_name,\n        case\n            when lower(active) in ('yes', 'true', '1') then true\n            when lower(active) in ('no', 'false', '0') then false\n        end as is_active,\n        type as activity_type\n    from source\n)\n\nselect *\nfrom renamed", "relation_name": "\"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"stg_pipedrive_activity_types\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:49.624505Z", "completed_at": "2026-01-31T20:54:49.631052Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:49.632596Z", "completed_at": "2026-01-31T20:54:49.632670Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009235620498657227, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.enpal_assessment_project.stg_pipedrive_deal_changes", "compiled": true, "compiled_code": "\n\nwith source as (\n    select *\n    from \"postgres\".\"public\".\"deal_changes\"\n    \n    where change_time::timestamp >= (\n        select coalesce(max(changed_at), '1900-01-01'::timestamp)\n        from \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"stg_pipedrive_deal_changes\"\n    )\n    \n),\n\nrenamed as (\n    select\n        deal_id::int as deal_id,\n        change_time::timestamp as changed_at,\n        changed_field_key as changed_field_key,\n        new_value as new_value\n    from source\n)\n\nselect *\nfrom renamed", "relation_name": "\"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"stg_pipedrive_deal_changes\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:49.636815Z", "completed_at": "2026-01-31T20:54:49.641782Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:49.642779Z", "completed_at": "2026-01-31T20:54:49.643287Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009026288986206055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.enpal_assessment_project.stg_pipedrive_fields", "compiled": true, "compiled_code": "\n\nwith source as (\n    select *\n    from \"postgres\".\"public\".\"fields\"\n),\n\nrenamed as (\n    select\n        id::int as field_id,\n        field_key as field_key,\n        name as field_name,\n        field_value_options::jsonb as field_value_options\n    from source\n)\n\nselect *\nfrom renamed", "relation_name": "\"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"stg_pipedrive_fields\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:49.646844Z", "completed_at": "2026-01-31T20:54:49.651525Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:49.653037Z", "completed_at": "2026-01-31T20:54:49.653037Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008740425109863281, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.enpal_assessment_project.stg_pipedrive_stages", "compiled": true, "compiled_code": "\n\nwith source as (\n    select *\n    from \"postgres\".\"public\".\"stages\"\n),\n\nrenamed as (\n    select\n        stage_id::int as stage_id,\n        stage_name as stage_name\n    from source\n)\n\nselect *\nfrom renamed", "relation_name": "\"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"stg_pipedrive_stages\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:49.657148Z", "completed_at": "2026-01-31T20:54:49.662263Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:49.663235Z", "completed_at": "2026-01-31T20:54:49.663235Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008699178695678711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.enpal_assessment_project.stg_pipedrive_users", "compiled": true, "compiled_code": "\n\nwith source as (\n    select *\n    from \"postgres\".\"public\".\"users\"\n),\n\nrenamed as (\n    select\n        id::int as user_id,\n        name as user_name,\n        email as email,\n        modified::timestamp as modified_at\n    from source\n)\n\nselect *\nfrom renamed", "relation_name": "\"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"stg_pipedrive_users\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:49.666898Z", "completed_at": "2026-01-31T20:54:49.669929Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:49.670899Z", "completed_at": "2026-01-31T20:54:49.670899Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0051441192626953125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.enpal_assessment_project.funnel_activity_mapping", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:49.674442Z", "completed_at": "2026-01-31T20:54:49.676990Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:49.678025Z", "completed_at": "2026-01-31T20:54:49.678025Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004624843597412109, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.enpal_assessment_project.funnel_stage_mapping", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:49.682163Z", "completed_at": "2026-01-31T20:54:49.700475Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:49.701477Z", "completed_at": "2026-01-31T20:54:49.701477Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.020825862884521484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.source_not_null_postgres_public_activity_activity_id.0053daa374", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect activity_id\nfrom \"postgres\".\"public\".\"activity\"\nwhere activity_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:49.706105Z", "completed_at": "2026-01-31T20:54:49.713619Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:49.714618Z", "completed_at": "2026-01-31T20:54:49.714618Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01018071174621582, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.source_not_null_postgres_public_activity_types_id.5805169997", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom \"postgres\".\"public\".\"activity_types\"\nwhere id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:49.717670Z", "completed_at": "2026-01-31T20:54:49.723671Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:49.725806Z", "completed_at": "2026-01-31T20:54:49.725806Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009170055389404297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.source_not_null_postgres_public_deal_changes_change_time.967be6a903", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect change_time\nfrom \"postgres\".\"public\".\"deal_changes\"\nwhere change_time is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:49.728813Z", "completed_at": "2026-01-31T20:54:49.734814Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:49.736330Z", "completed_at": "2026-01-31T20:54:49.736330Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008515119552612305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.source_not_null_postgres_public_deal_changes_changed_field_key.ba0d625128", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect changed_field_key\nfrom \"postgres\".\"public\".\"deal_changes\"\nwhere changed_field_key is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:49.739372Z", "completed_at": "2026-01-31T20:54:49.747542Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:49.748541Z", "completed_at": "2026-01-31T20:54:49.748541Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010202646255493164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.source_not_null_postgres_public_deal_changes_deal_id.cb1512dbeb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect deal_id\nfrom \"postgres\".\"public\".\"deal_changes\"\nwhere deal_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:49.752541Z", "completed_at": "2026-01-31T20:54:49.759648Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:49.760649Z", "completed_at": "2026-01-31T20:54:49.760649Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010107994079589844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.source_not_null_postgres_public_fields_field_key.c7054cc078", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect field_key\nfrom \"postgres\".\"public\".\"fields\"\nwhere field_key is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:49.763942Z", "completed_at": "2026-01-31T20:54:49.770454Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:49.772091Z", "completed_at": "2026-01-31T20:54:49.772091Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009441614151000977, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.source_not_null_postgres_public_fields_id.4b6ff5ce7d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom \"postgres\".\"public\".\"fields\"\nwhere id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:49.776642Z", "completed_at": "2026-01-31T20:54:49.783648Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:49.784647Z", "completed_at": "2026-01-31T20:54:49.784647Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010026931762695312, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.source_not_null_postgres_public_stages_stage_id.647cdf190c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect stage_id\nfrom \"postgres\".\"public\".\"stages\"\nwhere stage_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:49.788168Z", "completed_at": "2026-01-31T20:54:49.795671Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:49.796682Z", "completed_at": "2026-01-31T20:54:49.796682Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009400367736816406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.source_not_null_postgres_public_stages_stage_name.28dd861171", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect stage_name\nfrom \"postgres\".\"public\".\"stages\"\nwhere stage_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:49.800200Z", "completed_at": "2026-01-31T20:54:49.806272Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:49.807780Z", "completed_at": "2026-01-31T20:54:49.807780Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008580207824707031, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.source_not_null_postgres_public_users_id.539af692d1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom \"postgres\".\"public\".\"users\"\nwhere id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:49.810787Z", "completed_at": "2026-01-31T20:54:49.821470Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:49.822474Z", "completed_at": "2026-01-31T20:54:49.822474Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01268768310546875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.source_unique_postgres_public_activity_types_id.4fad3748ba", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"public\".\"activity_types\"\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:49.825977Z", "completed_at": "2026-01-31T20:54:49.831023Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:49.832026Z", "completed_at": "2026-01-31T20:54:49.832026Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007554054260253906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.source_unique_postgres_public_fields_id.07c10e32b7", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"public\".\"fields\"\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:49.836037Z", "completed_at": "2026-01-31T20:54:49.842069Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:49.843072Z", "completed_at": "2026-01-31T20:54:49.843072Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009045600891113281, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.source_unique_postgres_public_stages_stage_id.c42bb03b32", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    stage_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"public\".\"stages\"\nwhere stage_id is not null\ngroup by stage_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:49.846067Z", "completed_at": "2026-01-31T20:54:49.851797Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:49.852800Z", "completed_at": "2026-01-31T20:54:49.852800Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008714914321899414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.source_unique_postgres_public_users_id.981d49341d", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"public\".\"users\"\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:49.855796Z", "completed_at": "2026-01-31T20:54:49.862388Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:49.863386Z", "completed_at": "2026-01-31T20:54:49.863386Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009585857391357422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_stg_pipedrive_activity_activity_id.2bc1c90671", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect activity_id\nfrom \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"stg_pipedrive_activity\"\nwhere activity_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:49.868495Z", "completed_at": "2026-01-31T20:54:49.875045Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:49.876552Z", "completed_at": "2026-01-31T20:54:49.876552Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010065317153930664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.enpal_assessment_project.int_pipedrive_deal_sales_calls", "compiled": true, "compiled_code": "-- Base activity records with deal linkage and completion status.\nwith activities as (\n    select\n        activity_id,\n        activity_type,\n        deal_id,\n        is_done,\n        due_at\n    from \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"stg_pipedrive_activity\"\n),\n\n-- Activity type metadata to map type keys to human-readable names.\nactivity_types as (\n    select\n        activity_type,\n        activity_type_name\n    from \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"stg_pipedrive_activity_types\"\n),\n\n-- Keep only completed Sales Call 1/2 activities.\nsales_calls as (\n    select\n        a.deal_id,\n        t.activity_type_name,\n        a.due_at\n    from activities a\n    inner join activity_types t\n        on a.activity_type = t.activity_type\n    where t.activity_type_name in ('Sales Call 1', 'Sales Call 2')\n      and a.is_done is true\n      and a.due_at is not null\n),\n\n-- Capture the first completed sales call per deal and call type.\nfirst_calls as (\n    select\n        deal_id,\n        activity_type_name,\n        min(due_at) as first_call_at\n    from sales_calls\n    group by\n        deal_id,\n        activity_type_name\n)\n\nselect *\nfrom first_calls", "relation_name": "\"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"int_pipedrive_deal_sales_calls\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:49.881086Z", "completed_at": "2026-01-31T20:54:49.887110Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:49.888113Z", "completed_at": "2026-01-31T20:54:49.888113Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009045600891113281, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_stg_pipedrive_activity_types_activity_type_id.33d8b22c12", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect activity_type_id\nfrom \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"stg_pipedrive_activity_types\"\nwhere activity_type_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:49.891630Z", "completed_at": "2026-01-31T20:54:49.900427Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:49.900967Z", "completed_at": "2026-01-31T20:54:49.900967Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011881828308105469, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.unique_stg_pipedrive_activity_types_activity_type_id.bce71651b8", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    activity_type_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"stg_pipedrive_activity_types\"\nwhere activity_type_id is not null\ngroup by activity_type_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:49.904750Z", "completed_at": "2026-01-31T20:54:49.910877Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:49.912485Z", "completed_at": "2026-01-31T20:54:49.912485Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009340524673461914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_stg_pipedrive_deal_changes_deal_id.4adda154e9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect deal_id\nfrom \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"stg_pipedrive_deal_changes\"\nwhere deal_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:49.918034Z", "completed_at": "2026-01-31T20:54:49.924482Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:49.925994Z", "completed_at": "2026-01-31T20:54:49.925994Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009990453720092773, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_stg_pipedrive_fields_field_id.6e06bcc242", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect field_id\nfrom \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"stg_pipedrive_fields\"\nwhere field_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:49.930151Z", "completed_at": "2026-01-31T20:54:49.936682Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:49.937683Z", "completed_at": "2026-01-31T20:54:49.937683Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010069847106933594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.unique_stg_pipedrive_fields_field_id.9d24fea29f", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    field_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"stg_pipedrive_fields\"\nwhere field_id is not null\ngroup by field_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:49.941189Z", "completed_at": "2026-01-31T20:54:49.948251Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:49.948251Z", "completed_at": "2026-01-31T20:54:49.948251Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009574413299560547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_stg_pipedrive_stages_stage_id.80d868c4c9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect stage_id\nfrom \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"stg_pipedrive_stages\"\nwhere stage_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:49.951779Z", "completed_at": "2026-01-31T20:54:49.958906Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:49.959915Z", "completed_at": "2026-01-31T20:54:49.959915Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009146928787231445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.unique_stg_pipedrive_stages_stage_id.0b76df7c22", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    stage_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"stg_pipedrive_stages\"\nwhere stage_id is not null\ngroup by stage_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:49.962965Z", "completed_at": "2026-01-31T20:54:49.969176Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:49.970155Z", "completed_at": "2026-01-31T20:54:49.970155Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008726835250854492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_stg_pipedrive_users_user_id.b021926dbb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"stg_pipedrive_users\"\nwhere user_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:49.974216Z", "completed_at": "2026-01-31T20:54:49.984372Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:49.984372Z", "completed_at": "2026-01-31T20:54:49.984372Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01169443130493164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.unique_stg_pipedrive_users_user_id.8ea08d0cae", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    user_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"stg_pipedrive_users\"\nwhere user_id is not null\ngroup by user_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:49.987915Z", "completed_at": "2026-01-31T20:54:49.994046Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:49.995049Z", "completed_at": "2026-01-31T20:54:49.995049Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008133649826049805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.enpal_assessment_project.dim_activity_type", "compiled": true, "compiled_code": "-- Activity type dimension with mapping to funnel sub-steps.\nwith activity_types as (\n    select\n        activity_type_id,\n        activity_type_name,\n        is_active,\n        activity_type\n    from \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"stg_pipedrive_activity_types\"\n),\n\nmapped as (\n    select\n        activity_type_id,\n        activity_types.activity_type_name,\n        is_active,\n        activity_type,\n        mapping.funnel_step,\n        mapping.kpi_name\n    from activity_types\n    left join \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"funnel_activity_mapping\" mapping\n        on lower(activity_types.activity_type_name) = lower(mapping.activity_type_name)\n)\n\nselect *\nfrom mapped", "relation_name": "\"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"dim_activity_type\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:49.998324Z", "completed_at": "2026-01-31T20:54:50.005890Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:50.006899Z", "completed_at": "2026-01-31T20:54:50.006899Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010851383209228516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_funnel_activity_mapping_activity_type_name.c02c310ebd", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect activity_type_name\nfrom \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"funnel_activity_mapping\"\nwhere activity_type_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:50.010895Z", "completed_at": "2026-01-31T20:54:50.018923Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:50.018923Z", "completed_at": "2026-01-31T20:54:50.018923Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011024713516235352, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_funnel_activity_mapping_funnel_step.bf66d5a11b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect funnel_step\nfrom \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"funnel_activity_mapping\"\nwhere funnel_step is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:50.023024Z", "completed_at": "2026-01-31T20:54:50.029554Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:50.030554Z", "completed_at": "2026-01-31T20:54:50.030554Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009044408798217773, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_funnel_activity_mapping_kpi_name.5125212d7a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect kpi_name\nfrom \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"funnel_activity_mapping\"\nwhere kpi_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:50.034068Z", "completed_at": "2026-01-31T20:54:50.040583Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:50.040583Z", "completed_at": "2026-01-31T20:54:50.040583Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010027170181274414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.unique_funnel_activity_mapping_activity_type_name.0de146e667", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    activity_type_name as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"funnel_activity_mapping\"\nwhere activity_type_name is not null\ngroup by activity_type_name\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:50.045096Z", "completed_at": "2026-01-31T20:54:50.052199Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:50.052199Z", "completed_at": "2026-01-31T20:54:50.052199Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010135889053344727, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.enpal_assessment_project.dim_stage", "compiled": true, "compiled_code": "-- Stage dimension with canonical funnel step mapping.\nwith stages as (\n    select\n        stage_id,\n        stage_name\n    from \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"stg_pipedrive_stages\"\n),\n\nmapped as (\n    select\n        stage_id,\n        stages.stage_name,\n        mapping.funnel_step,\n        mapping.kpi_name\n    from stages\n    left join \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"funnel_stage_mapping\" mapping\n        on lower(stages.stage_name) = lower(mapping.stage_name)\n)\n\nselect *\nfrom mapped", "relation_name": "\"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"dim_stage\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:50.057237Z", "completed_at": "2026-01-31T20:54:50.061750Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:50.062751Z", "completed_at": "2026-01-31T20:54:50.062751Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007025718688964844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.enpal_assessment_project.int_pipedrive_deal_stage_events", "compiled": true, "compiled_code": "-- Extract only stage change events from the deal change log.\nwith stage_changes as (\n    select\n        deal_id,\n        changed_at,\n        -- new_value holds the stage_id when changed_field_key = 'stage_id'\n        new_value::int as stage_id\n    from \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"stg_pipedrive_deal_changes\"\n    where changed_field_key = 'stage_id'\n      and new_value is not null\n),\n\n-- Reference mapping of stage_id to stage_name as configured in Pipedrive.\nstages as (\n    select\n        stage_id,\n        stage_name\n    from \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"stg_pipedrive_stages\"\n),\n\nmapping as (\n    select\n        stage_name,\n        kpi_name\n    from \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"funnel_stage_mapping\"\n),\n\n-- Attach canonical KPI names to each stage change event.\njoined as (\n    select\n        sc.deal_id,\n        sc.changed_at,\n        sc.stage_id,\n        s.stage_name,\n        mapping.kpi_name as funnel_stage_name\n    from stage_changes sc\n    left join stages s\n        on sc.stage_id = s.stage_id\n    left join mapping\n        on lower(s.stage_name) = lower(mapping.stage_name)\n)\n\nselect *\nfrom joined", "relation_name": "\"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"int_pipedrive_deal_stage_events\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:50.065776Z", "completed_at": "2026-01-31T20:54:50.072326Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:50.073834Z", "completed_at": "2026-01-31T20:54:50.073834Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010097742080688477, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_funnel_stage_mapping_funnel_step.a5ba2d1c4a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect funnel_step\nfrom \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"funnel_stage_mapping\"\nwhere funnel_step is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:50.076878Z", "completed_at": "2026-01-31T20:54:50.082973Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:50.082973Z", "completed_at": "2026-01-31T20:54:50.082973Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008615970611572266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_funnel_stage_mapping_kpi_name.969f24be85", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect kpi_name\nfrom \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"funnel_stage_mapping\"\nwhere kpi_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:50.087012Z", "completed_at": "2026-01-31T20:54:50.092012Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:50.093014Z", "completed_at": "2026-01-31T20:54:50.093014Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008525848388671875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_funnel_stage_mapping_stage_name.a639e91c6a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect stage_name\nfrom \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"funnel_stage_mapping\"\nwhere stage_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:50.096038Z", "completed_at": "2026-01-31T20:54:50.103597Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:50.105106Z", "completed_at": "2026-01-31T20:54:50.105106Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010618448257446289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.unique_funnel_stage_mapping_stage_name.ff548c25f0", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    stage_name as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"funnel_stage_mapping\"\nwhere stage_name is not null\ngroup by stage_name\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:50.108644Z", "completed_at": "2026-01-31T20:54:50.115252Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:50.115762Z", "completed_at": "2026-01-31T20:54:50.115762Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008123636245727539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.enpal_assessment_project.fct_deal_sales_calls", "compiled": true, "compiled_code": "\n\n-- One row per deal and sales call type for the first completed call timestamp.\nselect\n    deal_id,\n    activity_type_name,\n    first_call_at\nfrom \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"int_pipedrive_deal_sales_calls\"", "relation_name": "\"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"fct_deal_sales_calls\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:50.119768Z", "completed_at": "2026-01-31T20:54:50.128285Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:50.128285Z", "completed_at": "2026-01-31T20:54:50.128285Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011514663696289062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_int_pipedrive_deal_sales_calls_activity_type_name.60885ba463", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect activity_type_name\nfrom \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"int_pipedrive_deal_sales_calls\"\nwhere activity_type_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:50.132846Z", "completed_at": "2026-01-31T20:54:50.139960Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:50.139960Z", "completed_at": "2026-01-31T20:54:50.139960Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010116100311279297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_int_pipedrive_deal_sales_calls_deal_id.a1ad5bdd50", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect deal_id\nfrom \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"int_pipedrive_deal_sales_calls\"\nwhere deal_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:50.144563Z", "completed_at": "2026-01-31T20:54:50.152101Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:50.152101Z", "completed_at": "2026-01-31T20:54:50.152101Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010146617889404297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_int_pipedrive_deal_sales_calls_first_call_at.1921f9a927", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect first_call_at\nfrom \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"int_pipedrive_deal_sales_calls\"\nwhere first_call_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:50.156631Z", "completed_at": "2026-01-31T20:54:50.164291Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:50.164291Z", "completed_at": "2026-01-31T20:54:50.164291Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009174346923828125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_dim_activity_type_activity_type_id.1ea41ea9e7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect activity_type_id\nfrom \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"dim_activity_type\"\nwhere activity_type_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:50.168322Z", "completed_at": "2026-01-31T20:54:50.175507Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:50.177045Z", "completed_at": "2026-01-31T20:54:50.177045Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00973057746887207, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_dim_activity_type_activity_type_name.dc8d7c6206", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect activity_type_name\nfrom \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"dim_activity_type\"\nwhere activity_type_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:50.181133Z", "completed_at": "2026-01-31T20:54:50.187226Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:50.188266Z", "completed_at": "2026-01-31T20:54:50.188266Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009133100509643555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_dim_activity_type_funnel_step.436c37e5ad", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect funnel_step\nfrom (select * from \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"dim_activity_type\" where activity_type_name in ('Sales Call 1','Sales Call 2')) dbt_subquery\nwhere funnel_step is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:50.191771Z", "completed_at": "2026-01-31T20:54:50.199289Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:50.200290Z", "completed_at": "2026-01-31T20:54:50.200290Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009525537490844727, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_dim_activity_type_kpi_name.922f8af0c9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect kpi_name\nfrom (select * from \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"dim_activity_type\" where activity_type_name in ('Sales Call 1','Sales Call 2')) dbt_subquery\nwhere kpi_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:50.203289Z", "completed_at": "2026-01-31T20:54:50.209901Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:50.210904Z", "completed_at": "2026-01-31T20:54:50.210904Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008613824844360352, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.unique_dim_activity_type_activity_type_id.73742a96ad", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    activity_type_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"dim_activity_type\"\nwhere activity_type_id is not null\ngroup by activity_type_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:50.213902Z", "completed_at": "2026-01-31T20:54:50.219478Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:50.219478Z", "completed_at": "2026-01-31T20:54:50.219478Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008577108383178711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_dim_stage_funnel_step.f06de2adc1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect funnel_step\nfrom \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"dim_stage\"\nwhere funnel_step is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:50.223073Z", "completed_at": "2026-01-31T20:54:50.229578Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:50.230580Z", "completed_at": "2026-01-31T20:54:50.230580Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008527040481567383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_dim_stage_kpi_name.3aced2aebf", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect kpi_name\nfrom \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"dim_stage\"\nwhere kpi_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:50.233579Z", "completed_at": "2026-01-31T20:54:50.239602Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:50.240605Z", "completed_at": "2026-01-31T20:54:50.240605Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008027315139770508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_dim_stage_stage_id.8bcdbbd953", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect stage_id\nfrom \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"dim_stage\"\nwhere stage_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:50.244603Z", "completed_at": "2026-01-31T20:54:50.250629Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:50.251630Z", "completed_at": "2026-01-31T20:54:50.251630Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009024858474731445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.unique_dim_stage_stage_id.be750ff620", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    stage_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"dim_stage\"\nwhere stage_id is not null\ngroup by stage_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:50.256720Z", "completed_at": "2026-01-31T20:54:50.261754Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:50.261754Z", "completed_at": "2026-01-31T20:54:50.261754Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008565187454223633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.enpal_assessment_project.int_pipedrive_deal_stage_firsts", "compiled": true, "compiled_code": "-- Stage change events per deal, potentially multiple per stage.\nwith stage_events as (\n    select *\n    from \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"int_pipedrive_deal_stage_events\"\n),\n\n-- Capture the first time a deal entered each stage.\nfirsts as (\n    select\n        deal_id,\n        stage_id,\n        funnel_stage_name,\n        min(changed_at) as stage_entered_at\n    from stage_events\n    group by\n        deal_id,\n        stage_id,\n        funnel_stage_name\n)\n\nselect *\nfrom firsts", "relation_name": "\"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"int_pipedrive_deal_stage_firsts\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:50.265765Z", "completed_at": "2026-01-31T20:54:50.272796Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:50.274300Z", "completed_at": "2026-01-31T20:54:50.274300Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010538816452026367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_int_pipedrive_deal_stage_events_changed_at.dce12a7b69", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect changed_at\nfrom \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"int_pipedrive_deal_stage_events\"\nwhere changed_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:50.276811Z", "completed_at": "2026-01-31T20:54:50.281890Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:50.282899Z", "completed_at": "2026-01-31T20:54:50.282899Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007094383239746094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_int_pipedrive_deal_stage_events_deal_id.0548ab517f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect deal_id\nfrom \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"int_pipedrive_deal_stage_events\"\nwhere deal_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:50.285974Z", "completed_at": "2026-01-31T20:54:50.291565Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:50.292567Z", "completed_at": "2026-01-31T20:54:50.292567Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008107662200927734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_int_pipedrive_deal_stage_events_stage_id.0589d439a6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect stage_id\nfrom \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"int_pipedrive_deal_stage_events\"\nwhere stage_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:50.296085Z", "completed_at": "2026-01-31T20:54:50.302242Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:50.303246Z", "completed_at": "2026-01-31T20:54:50.303246Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009681463241577148, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_fct_deal_sales_calls_deal_id.645db6c0cf", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect deal_id\nfrom \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"fct_deal_sales_calls\"\nwhere deal_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:50.305750Z", "completed_at": "2026-01-31T20:54:50.310755Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:50.311977Z", "completed_at": "2026-01-31T20:54:50.311977Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0077321529388427734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_fct_deal_sales_calls_first_call_at.203e192e0b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect first_call_at\nfrom \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"fct_deal_sales_calls\"\nwhere first_call_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:50.315612Z", "completed_at": "2026-01-31T20:54:50.326643Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:50.326643Z", "completed_at": "2026-01-31T20:54:50.326643Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.012045145034790039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.relationships_fct_deal_sales_calls_activity_type_name__activity_type_name__ref_dim_activity_type_.478761c622", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select activity_type_name as from_field\n    from \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"fct_deal_sales_calls\"\n    where activity_type_name is not null\n),\n\nparent as (\n    select activity_type_name as to_field\n    from \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"dim_activity_type\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:50.330241Z", "completed_at": "2026-01-31T20:54:50.336807Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:50.337806Z", "completed_at": "2026-01-31T20:54:50.337806Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009163379669189453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.enpal_assessment_project.dim_date", "compiled": true, "compiled_code": "-- Monthly date spine used for reporting at month-end grain.\nwith stage_firsts as (\n    select\n        stage_entered_at\n    from \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"int_pipedrive_deal_stage_firsts\"\n),\n\nsales_calls as (\n    select\n        first_call_at\n    from \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"int_pipedrive_deal_sales_calls\"\n),\n\nall_dates as (\n    select stage_entered_at as event_ts from stage_firsts\n    union all\n    select first_call_at as event_ts from sales_calls\n),\n\nbounds as (\n    select\n        min(event_ts) as min_ts,\n        max(event_ts) as max_ts\n    from all_dates\n),\n\nmonths as (\n    select\n        date_trunc('month', dd)::date as month_start,\n        (date_trunc('month', dd) + interval '1 month - 1 day')::date as month_end\n    from bounds,\n         generate_series(\n             date_trunc('month', min_ts),\n             date_trunc('month', max_ts),\n             interval '1 month'\n         ) as dd\n    where min_ts is not null\n      and max_ts is not null\n)\n\nselect *\nfrom months", "relation_name": "\"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"dim_date\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:50.339815Z", "completed_at": "2026-01-31T20:54:50.345903Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:50.346842Z", "completed_at": "2026-01-31T20:54:50.346842Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0070269107818603516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.enpal_assessment_project.fct_deal_stage_firsts", "compiled": true, "compiled_code": "\n\n-- One row per deal and stage for the first entry timestamp.\nselect\n    deal_id,\n    stage_id,\n    stage_entered_at\nfrom \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"int_pipedrive_deal_stage_firsts\"", "relation_name": "\"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"fct_deal_stage_firsts\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:50.349875Z", "completed_at": "2026-01-31T20:54:50.355965Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:50.356976Z", "completed_at": "2026-01-31T20:54:50.356976Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008134126663208008, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_int_pipedrive_deal_stage_firsts_deal_id.754b8f2035", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect deal_id\nfrom \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"int_pipedrive_deal_stage_firsts\"\nwhere deal_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:50.360009Z", "completed_at": "2026-01-31T20:54:50.366922Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:50.367927Z", "completed_at": "2026-01-31T20:54:50.367927Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008954763412475586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_int_pipedrive_deal_stage_firsts_stage_entered_at.1cab190b2a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect stage_entered_at\nfrom \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"int_pipedrive_deal_stage_firsts\"\nwhere stage_entered_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:50.370954Z", "completed_at": "2026-01-31T20:54:50.377745Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:50.378757Z", "completed_at": "2026-01-31T20:54:50.378757Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008799552917480469, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_int_pipedrive_deal_stage_firsts_stage_id.2cda913e2d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect stage_id\nfrom \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"int_pipedrive_deal_stage_firsts\"\nwhere stage_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:50.382295Z", "completed_at": "2026-01-31T20:54:50.389882Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:50.390883Z", "completed_at": "2026-01-31T20:54:50.390883Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010129451751708984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_dim_date_month_end.24f172f7ff", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect month_end\nfrom \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"dim_date\"\nwhere month_end is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:50.395093Z", "completed_at": "2026-01-31T20:54:50.404259Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:50.405768Z", "completed_at": "2026-01-31T20:54:50.405768Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.012717723846435547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_dim_date_month_start.218538c0fc", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect month_start\nfrom \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"dim_date\"\nwhere month_start is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:50.408422Z", "completed_at": "2026-01-31T20:54:50.414975Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:50.415948Z", "completed_at": "2026-01-31T20:54:50.415948Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00916910171508789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.unique_dim_date_month_end.f04da99519", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    month_end as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"dim_date\"\nwhere month_end is not null\ngroup by month_end\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:50.419115Z", "completed_at": "2026-01-31T20:54:50.425625Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:50.426902Z", "completed_at": "2026-01-31T20:54:50.426902Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008787155151367188, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.unique_dim_date_month_start.a9c160f67f", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    month_start as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"dim_date\"\nwhere month_start is not null\ngroup by month_start\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:50.430903Z", "completed_at": "2026-01-31T20:54:50.437940Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:50.439037Z", "completed_at": "2026-01-31T20:54:50.439037Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010641336441040039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.enpal_assessment_project.rep_sales_funnel_monthly", "compiled": true, "compiled_code": "\n\n-- Monthly sales funnel KPI counts with complete month coverage and month-end dates.\nwith dim_date as (\n    select\n        month_start,\n        month_end\n    from \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"dim_date\"\n),\n\ndim_stage as (\n    select\n        stage_id,\n        funnel_step,\n        kpi_name\n    from \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"dim_stage\"\n),\n\ndim_activity_type as (\n    select\n        activity_type_name,\n        funnel_step,\n        kpi_name\n    from \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"dim_activity_type\"\n    where funnel_step is not null\n),\n\nfct_stage_firsts as (\n    select\n        deal_id,\n        stage_id,\n        stage_entered_at\n    from \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"fct_deal_stage_firsts\"\n),\n\nfct_sales_calls as (\n    select\n        deal_id,\n        activity_type_name,\n        first_call_at\n    from \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"fct_deal_sales_calls\"\n),\n\n-- Monthly counts for main stage-based funnel steps (1,2,3...9).\nstage_kpis as (\n    select\n        (date_trunc('month', f.stage_entered_at) + interval '1 month - 1 day')::date as month,\n        d.kpi_name as kpi_name,\n        d.funnel_step as funnel_step,\n        count(distinct f.deal_id) as deals_count\n    from fct_stage_firsts f\n    inner join dim_stage d\n        on f.stage_id = d.stage_id\n    where f.stage_entered_at is not null\n    group by\n        (date_trunc('month', f.stage_entered_at) + interval '1 month - 1 day')::date,\n        d.kpi_name,\n        d.funnel_step\n),\n\n-- Monthly counts for Sales Call 1 (2.1) and Sales Call 2 (3.1).\nsales_call_kpis as (\n    select\n        (date_trunc('month', f.first_call_at) + interval '1 month - 1 day')::date as month,\n        d.kpi_name as kpi_name,\n        d.funnel_step as funnel_step,\n        count(distinct f.deal_id) as deals_count\n    from fct_sales_calls f\n    inner join dim_activity_type d\n        on f.activity_type_name = d.activity_type_name\n    where f.first_call_at is not null\n    group by\n        (date_trunc('month', f.first_call_at) + interval '1 month - 1 day')::date,\n        d.kpi_name,\n        d.funnel_step\n),\n\n-- Combine stage steps and sales-call sub-steps.\nunioned as (\n    select * from stage_kpis\n    union all\n    select * from sales_call_kpis\n),\n\n-- Full KPI list for cross-join with months.\nall_kpis as (\n    select kpi_name, funnel_step from dim_stage\n    union\n    select kpi_name, funnel_step from dim_activity_type\n),\n\n-- Create complete grid of month x KPI and fill missing counts with 0.\nspined as (\n    select\n        d.month_end as month,\n        k.kpi_name,\n        k.funnel_step,\n        coalesce(u.deals_count, 0) as deals_count\n    from dim_date d\n    cross join all_kpis k\n    left join unioned u\n        on u.month = d.month_end\n       and u.kpi_name = k.kpi_name\n       and u.funnel_step = k.funnel_step\n)\n\nselect\n    month,\n    kpi_name,\n    funnel_step,\n    deals_count\nfrom spined\norder by\n    month,\n    case funnel_step\n        when '1' then 1\n        when '2' then 2\n        when '2.1' then 3\n        when '3' then 4\n        when '3.1' then 5\n        when '4' then 6\n        when '5' then 7\n        when '6' then 8\n        when '7' then 9\n        when '8' then 10\n        when '9' then 11\n        else 99\n    end", "relation_name": "\"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"rep_sales_funnel_monthly\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:50.442554Z", "completed_at": "2026-01-31T20:54:50.449117Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:50.450116Z", "completed_at": "2026-01-31T20:54:50.450116Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008561372756958008, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_fct_deal_stage_firsts_deal_id.23edf4ab18", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect deal_id\nfrom \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"fct_deal_stage_firsts\"\nwhere deal_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:50.452113Z", "completed_at": "2026-01-31T20:54:50.459794Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:50.460794Z", "completed_at": "2026-01-31T20:54:50.460794Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008681297302246094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_fct_deal_stage_firsts_stage_entered_at.98b19f15ae", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect stage_entered_at\nfrom \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"fct_deal_stage_firsts\"\nwhere stage_entered_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:50.463821Z", "completed_at": "2026-01-31T20:54:50.471538Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:50.472506Z", "completed_at": "2026-01-31T20:54:50.472506Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010651588439941406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.relationships_fct_deal_stage_firsts_stage_id__stage_id__ref_dim_stage_.c4032f5f4a", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select stage_id as from_field\n    from \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"fct_deal_stage_firsts\"\n    where stage_id is not null\n),\n\nparent as (\n    select stage_id as to_field\n    from \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"dim_stage\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:50.476535Z", "completed_at": "2026-01-31T20:54:50.494831Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:50.495841Z", "completed_at": "2026-01-31T20:54:50.495841Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.021325349807739258, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.accepted_values_rep_sales_funnel_monthly_funnel_step__1__2__2_1__3__3_1__4__5__6__7__8__9.8c528098bc", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        funnel_step as value_field,\n        count(*) as n_records\n\n    from \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"rep_sales_funnel_monthly\"\n    group by funnel_step\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    '1','2','2.1','3','3.1','4','5','6','7','8','9'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:50.499360Z", "completed_at": "2026-01-31T20:54:50.505532Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:50.506041Z", "completed_at": "2026-01-31T20:54:50.506041Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008677005767822266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_deals_count.4823926246", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect deals_count\nfrom \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"rep_sales_funnel_monthly\"\nwhere deals_count is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:50.509048Z", "completed_at": "2026-01-31T20:54:50.515633Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:50.516788Z", "completed_at": "2026-01-31T20:54:50.516788Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008741140365600586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect kpi_name\nfrom \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"rep_sales_funnel_monthly\"\nwhere kpi_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:50.520308Z", "completed_at": "2026-01-31T20:54:50.526823Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:50.527824Z", "completed_at": "2026-01-31T20:54:50.527824Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008515596389770508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month.d7af6eff7b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect month\nfrom \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"rep_sales_funnel_monthly\"\nwhere month is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:50.530821Z", "completed_at": "2026-01-31T20:54:50.537975Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:50.538976Z", "completed_at": "2026-01-31T20:54:50.538976Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009154081344604492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.relationships_rep_sales_funnel_monthly_month__month_end__ref_dim_date_.9c48beb95b", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select month as from_field\n    from \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"rep_sales_funnel_monthly\"\n    where month is not null\n),\n\nparent as (\n    select month_end as to_field\n    from \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"dim_date\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:50.541975Z", "completed_at": "2026-01-31T20:54:50.547554Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:50.548078Z", "completed_at": "2026-01-31T20:54:50.548078Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007103681564331055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.test_rep_sales_funnel_monthly_kpi_valid", "compiled": true, "compiled_code": "with allowed as (\n    select kpi_name, funnel_step from \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"dim_stage\"\n    union\n    select kpi_name, funnel_step\n    from \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"dim_activity_type\"\n    where funnel_step is not null\n)\n\nselect r.*\nfrom \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"rep_sales_funnel_monthly\" r\nleft join allowed a\n    on r.kpi_name = a.kpi_name\n   and r.funnel_step = a.funnel_step\nwhere a.kpi_name is null", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T20:54:50.551086Z", "completed_at": "2026-01-31T20:54:50.557930Z"}, {"name": "execute", "started_at": "2026-01-31T20:54:50.557930Z", "completed_at": "2026-01-31T20:54:50.558926Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008839130401611328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.test_rep_sales_funnel_monthly_non_negative", "compiled": true, "compiled_code": "select *\nfrom \"postgres\".\"pipedrive_analytics_pipedrive_analytics\".\"rep_sales_funnel_monthly\"\nwhere deals_count < 0", "relation_name": null, "batch_results": null}], "elapsed_time": 1.2110860347747803, "args": {"log_file_max_bytes": 10485760, "skip_nodes_if_on_run_start_fails": false, "quiet": false, "log_level": "info", "introspect": true, "macro_debugging": false, "version_check": true, "which": "generate", "require_ref_searches_node_package_before_root": false, "use_colors_file": true, "require_batched_execution_for_custom_microbatch_strategy": false, "partial_parse": true, "log_level_file": "debug", "cache_selected_only": false, "warn_error_options": {"error": [], "warn": [], "silence": []}, "validate_macro_args": false, "compile": true, "write_json": true, "populate_cache": true, "project_dir": "C:\\Users\\maaza\\Downloads\\clone 2\\dbt_enpal_assessment", "require_unique_project_resource_names": false, "show_resource_report": false, "send_anonymous_usage_stats": true, "require_all_warnings_handled_by_warn_error": false, "require_explicit_package_overrides_for_builtin_materializations": true, "printer_width": 80, "profiles_dir": "C:\\Users\\maaza\\Downloads\\clone 2\\dbt_enpal_assessment", "print": true, "state_modified_compare_vars": false, "favor_state": false, "upload_to_artifacts_ingest_api": false, "use_fast_test_edges": false, "invocation_command": "dbt docs generate", "strict_mode": false, "vars": {}, "empty_catalog": false, "require_yaml_configuration_for_mf_time_spines": false, "require_resource_names_without_spaces": true, "defer": false, "show_all_deprecations": false, "static": false, "exclude": [], "require_nested_cumulative_type_params": false, "log_path": "C:\\Users\\maaza\\Downloads\\clone 2\\dbt_enpal_assessment\\logs", "log_format": "default", "indirect_selection": "eager", "state_modified_compare_more_unrendered_values": false, "static_parser": true, "require_generic_test_arguments_property": true, "log_format_file": "debug", "source_freshness_run_project_hooks": true, "use_colors": true, "partial_parse_file_diff": true, "select": []}}